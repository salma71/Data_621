---
title: "Data 621 - Homework 5"
author: "Dhairav Chhatbar, Mael Illien, Salma Elshahawy"
date: "11/23/2020"
output: 
  html_document:
    code_folding: hide
    theme: cosmo
    highlight: tango
    toc: true
    number_section: false
    toc_float:
      collapsed: true
      smooth_scroll: true
    df_print: paged
---
# Data 621 Homework5 

## Introduction 

In this assignment, we are tasked with predicting the number of cases of wine sold to wine distribution companies following a sampling. The target variable, cases of wine sold, is count data and therefore will be modeled using appropriate techniques such as Poisson and Negative Binomial regressions. 

```{r message=FALSE, warning=FALSE, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, comment=NA, message=FALSE, warning=FALSE)
library(skimr)
library(ggcorrplot)
library(tidyverse)
library(PerformanceAnalytics)
library(DMwR)
library(caret)
library(kableExtra)
library(DescTools)
library(cowplot)
library(pROC)
library(broom)
library(car)
```

```{r message=FALSE, warning=FALSE}
data_train <- read.csv("https://raw.githubusercontent.com/salma71/Data_621/master/HW_5/wine-training-data.csv", header = TRUE)
data_test <- read.csv("https://raw.githubusercontent.com/salma71/Data_621/master/HW_5/wine-evaluation-data.csv", header = TRUE)
```

## Data Exploration {.tabset .tabset-fade .tabset-pills}

### Data Exploration

All the variable in this dataset are numeric and continuous except for `AcidIndex`, `STARS` and `LabelAppeal` which are discrete. The target variable `TARGET` is also discrete. There are a number of missing observations for certain chemical compositiion variables as well as a large number of wines with no `STARS` rating. The distribution of the continous variables appear well centered.


```{r data_summary_train, message=FALSE, warning=FALSE}
skim(data_train)
```

```{r variables_distribution, fig.height=8, fig.width=10, message=FALSE, warning=FALSE}
data_train %>% 
  dplyr::select(-INDEX) %>%
  gather() %>% 
  ggplot(aes(x=value)) + 
  geom_histogram(fill='pink') + 
  facet_wrap(~key, scales = 'free')
```

---

### Visualization


#### Correlations with Response Variable

```{r correlations_plot, fig.height=8, fig.width=10, message=FALSE, warning=FALSE}
corr_dataframe <- data_train %>%
    mutate_if(is.factor, as.numeric)
q <- cor(corr_dataframe)
ggcorrplot(q, type = "upper", outline.color = "white",
           ggtheme = theme_classic,
           colors = c("#6D9EC1", "white", "#E46726"),
           lab = TRUE, show.legend = FALSE, tl.cex = 8, lab_size = 3) 
```


## Data Preparation {.tabset .tabset-fade .tabset-pills}


## Model Building {.tabset .tabset-fade .tabset-pills}

### Model 1: Base Model

### Model 2: Observation Removal

## Model Selection 


```{r}
# data_test_trans <- data_test %>% select(-chas,-rm,-lstat)
# test_predict <- predict(mt1$model, newdata=data_test_trans)
# test_predict <- ifelse(test_predict<.5,0,1)
# 
# data_test$target <- test_predict
# 
# ggplot(data_test, aes(x=index(data_test), y=target, color=factor(target))) + geom_point() +
#   labs(x="Observation", y="target", title = "Model mt1 Prediction", colour = "target")
# 
# table(test_predict)
# 
# write.csv(test_predict, "CrimePredictions.csv")

```

